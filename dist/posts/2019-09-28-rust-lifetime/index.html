<!DOCTYPE html><html><head>
    <meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<title>Mis-Understanding Rust lifetime – Mechpen</title>


<link rel="icon" type="image/png" href="/assets/favicon.png">
<link rel="stylesheet" href="/assets/style.css">

    
    
    <link href="/assets/prism.css" rel="stylesheet">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css" rel="stylesheet">
    
  </head>

  <body>
    <div>
      <div class="container">
        <header class="masthead clearfix">
          <div class="site-info">
            <a href="/" class="site-name">Mechpen</a>
          </div>
          <nav>
	    <a href="/">posts</a>
	    <a href="/notes">notes</a>
	    <a href="/about">about</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <div class="post">
  <h1>Mis-Understanding Rust lifetime</h1>

  <div class="date">
    September 28, 2019
  </div>

  <div class="entry">
    <p>
Rust ownership and lifetime are very powerful tools.  They were
designed to help compiler get better optimization.  As a side
effect, they could force programmers to write cleaner code, even
design better interfaces.  Here are some theories and examples that
may help understanding lifetimes.  Disclaimer: I didn't read the
compiler code so I could be wrong.
</p>
    <p><strong>Update</strong> [Oct/20]: Prepend "<strong>Mis-</strong>" to the title as the theories
in this post are wrong.  Rust treats lifetimes as types, and converts
lifetimes according to the <a href="https://doc.rust-lang.org/nomicon/subtyping.html#variance">subtyping
rules</a>.
Every reference has a lifetime as its type.  This <a href="/posts/2019-10-20-rust-lifetime-mut/">follow up
post</a> has correct explanation of
rust lifetime.</p>
<h2 id="lifetime%2C-who's-lifetime" tabindex="-1"><a class="header-anchor" href="#lifetime%2C-who's-lifetime">Lifetime, who's lifetime</a></h2>
<p>It's very easy to confuse lifetimes with scopes.  In fact, they are
different concepts.</p>
<p>In rust code, all objects, including constants, owned variables and
references, have scopes.  Lifetime parameters are associated with
references to express relationships between scopes.  One lifetime
parameter could be associated with multiple references, and one
reference could have multiple associated lifetime parameters.</p>
<p>For the expression <code>x: &amp;'a T</code>, instead of saying <code>'a</code> is the lifetime
of <code>x</code>, we should say: <code>'a</code> is associated with the reference <code>x</code>.</p>
<p>In terms of algebra, scopes are values like 1, 2, 3, and lifetimes are
variables like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">x, y, z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span>.  Lifetime associations and rules creates
inequalities, and rust compiler tries to solve these inequalities.</p>
<h2 id="lifetime-rules" tabindex="-1"><a class="header-anchor" href="#lifetime-rules">Lifetime rules</a></h2>
<p>The following are the 3 fundamental lifetime rules and their meanings.
On the left of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">⇒</span></span></span></span> are rust expressions, on the right are
the implied algebraic relations.</p>
<ol>
<li>
<p>Association rule:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>x: &amp;'a T</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇒</mo><mspace width="0.277778em"></mspace><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">x</mi></mtext><mo>)</mo><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow><annotation encoding="application/x-tex">\;\Rightarrow\;scope(\text{x})\subseteq\text{'a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇒</span><span class="mord mspace thickspace"></span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">x</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span></span></p>
<p>A lifetime is a superset of the scope of its associated reference.</p>
</li>
<li>
<p>Reference rule:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>x: &amp;'a T = &amp;y</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇒</mo><mspace width="0.277778em"></mspace><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext><mo>⊆</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">y</mi></mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">\;\Rightarrow\;\text{'a}\subseteq scope(\text{y})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇒</span><span class="mord mspace thickspace"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span><span class="mrel">⊆</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span><span class="mclose">)</span></span></span></span></p>
<p>A lifetime associated with a reference is a subset of the scope of
the referent object.</p>
</li>
<li>
<p>Assignment rule:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>x: &amp;'a S = y: &amp;'b T</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇒</mo><mspace width="0.277778em"></mspace><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">b</mi></mtext></mrow><annotation encoding="application/x-tex">\;\Rightarrow\;\text{'a}\subseteq\text{'b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇒</span><span class="mord mspace thickspace"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">b</span></span></span></span></span></p>
<p>The lifetime associated with the assignee is a subset of the
lifetime associated with the assigner.</p>
<p>This assignment also contains a type rule:
<nobr><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">S</mi></mtext><mo>⊆</mo><mtext><mi mathvariant="normal">T</mi></mtext></mrow><annotation encoding="application/x-tex">\text{S}\subseteq\text{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">S</span></span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">T</span></span></span></span></span>,</nobr> i.e. <code>T</code> is a subtype of
<code>S</code>.</p>
</li>
</ol>
<p>From the above fundamental rules, we could deduce some useful rules:</p>
<ol start="4">
<li>
<p>Struct reference rule:</p>
<p>Given a struct <code>struct S&lt;'a&gt; { x: &amp;'a T }</code>, then</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>s: &amp;'b S&lt;'a&gt;</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇒</mo><mspace width="0.277778em"></mspace><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">b</mi></mtext><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow><annotation encoding="application/x-tex">\;\Rightarrow\;\text{'b}\subseteq\text{'a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇒</span><span class="mord mspace thickspace"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">b</span></span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span></span></p>
<p>The lifetime associated with a struct reference is a subset of the
lifetime associated with the struct member.</p>
<p><em>Proof</em>: For <code>s: &amp;'b S&lt;'a&gt;</code>, there must be an object <code>y: S&lt;'a&gt;</code>,
such that <code>s: &amp;'b S = &amp;y</code>.  Thus <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">b</mi></mtext><mo>⊆</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">y</mi></mtext><mo>)</mo><mo>=</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">y</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">x</mi></mtext><mo>)</mo><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow><annotation encoding="application/x-tex">\text{'b}\subseteq
scope(\text{y}) = scope(\text{y.x})\subseteq\text{'a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">b</span></span><span class="mrel">⊆</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="mord mathrm">.</span><span class="mord mathrm">x</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span></span>.</p>
</li>
<li>
<p>Double reference rule:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>x: &amp;'b &amp;'a T</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇒</mo><mspace width="0.277778em"></mspace><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">b</mi></mtext><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow><annotation encoding="application/x-tex">\;\Rightarrow\;\text{'b}\subseteq\text{'a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇒</span><span class="mord mspace thickspace"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">b</span></span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span></span></p>
<p>The proof is similar to the struct reference rule.</p>
</li>
</ol>
<p>There are also some special lifetime expressions:</p>
<ol start="6">
<li>
<p>Lifetime bound:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>'a: 'b</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇔</mo><mspace width="0.277778em"></mspace><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">b</mi></mtext><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow><annotation encoding="application/x-tex">\;\Leftrightarrow\;\text{'b}\subseteq\text{'a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇔</span><span class="mord mspace thickspace"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">b</span></span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span></span></p>
</li>
<li>
<p>Static scope:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span></span></span></span><code>'a</code> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="0.277778em"></mspace><mo>⇒</mo><mspace width="0.277778em"></mspace><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">c</mi></mtext></mrow><annotation encoding="application/x-tex">\;\Rightarrow\;\text{'a}\subseteq\text{'static}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mspace thickspace"></span><span class="mrel">⇒</span><span class="mord mspace thickspace"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">s</span><span class="mord mathrm">t</span><span class="mord mathrm">a</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm">c</span></span></span></span></span></p>
<p>Only static objects have static scopes.  Static objects are not
located in stack or heap.  They are located in data segments or
code segments that are mapped to the process memory.</p>
</li>
</ol>
<h2 id="examples" tabindex="-1"><a class="header-anchor" href="#examples">Examples</a></h2>
<h3 id="example-1" tabindex="-1"><a class="header-anchor" href="#example-1">Example 1</a></h3>
<p>The first simple example is from the
<a href="https://doc.rust-lang.org/stable/book/ch10-03-lifetime-syntax.html#preventing-dangling-references-with-lifetimes">rust book</a>.</p>
<div class="badcode"></div>
<pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token punctuation">{</span>
    <span class="token keyword">let</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        r <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"r: {}"</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>The compiler tries to associate a lifetime <code>'a</code> with reference <code>r</code>
that satisfies the follow inequalities:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace><mtable><mtr><mtd><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi></mtext><mo>)</mo><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace></mrow></mtd><mtd><mrow><mspace width="1em"></mspace></mrow></mtd><mtd><mrow><mrow></mrow><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mtext>&nbsp;</mtext><mn>1</mn></mtext></mrow></mtd></mtr><mtr><mtd><mrow><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext><mo>⊆</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">x</mi></mtext><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace></mrow></mtd><mtd><mrow><mspace width="1em"></mspace></mrow></mtd><mtd><mrow><mrow></mrow><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mtext>&nbsp;</mtext><mn>2</mn></mtext></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\quad\begin{aligned}
scope(\text{r})\subseteq\text{'a} &amp;\quad&amp;\quad &amp; \text{rule 1}\\
\text{'a}\subseteq scope(\text{x}) &amp;\quad&amp;\quad&amp; \text{rule 2}
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span><span class="mrel">⊆</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">x</span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mord mspace quad"></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mord mspace quad"></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:2em;"></span><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mspace quad"></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord mspace quad"></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">u</span><span class="mord mathrm">l</span><span class="mord mathrm">e</span><span class="mord mspace">&nbsp;</span><span class="mord mathrm">1</span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">u</span><span class="mord mathrm">l</span><span class="mord mathrm">e</span><span class="mord mspace">&nbsp;</span><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></p>
<p>This is not possible because <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">x</mi></mtext><mo>)</mo><mo>⊆</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi></mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">scope(\text{x})\subseteq
scope(\text{r})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">x</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span></span><span class="mclose">)</span></span></span></span>, so the code does not compile.</p>
<h3 id="example-2" tabindex="-1"><a class="header-anchor" href="#example-2">Example 2</a></h3>
<p>The second example is a modified version of an example in the
<a href="https://doc.rust-lang.org/stable/book/ch10-03-lifetime-syntax.html#lifetime-annotations-in-function-signatures">rust book</a>.</p>
<pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">longest</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">str</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> x<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> y<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        x
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"long string is long"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"xyz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> rs1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">;</span>
        <span class="token keyword">let</span> rs2 <span class="token operator">=</span> <span class="token operator">&amp;</span>s2<span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token function">longest</span><span class="token punctuation">(</span>rs1<span class="token punctuation">,</span> rs2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The longest string is {}"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>In this example, lifetime <code>'a</code> is associated with both <code>rs1</code> and
<code>rs2</code>.  The compiler needs to find a lifetime <code>'a</code> that satisfies:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"></mspace><mtable><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi><mn>1</mn></mtext><mo>)</mo><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext><mo>⊆</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">s</mi><mn>1</mn></mtext><mo>)</mo></mrow></mtd><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">s</mi><mn>2</mn></mtext><mo>)</mo><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext><mo>⊆</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">s</mi><mn>2</mn></mtext><mo>)</mo></mrow></mtd><mtd><mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mtext><mo>)</mo><mo>⊆</mo><mtext><mi mathvariant="normal">'</mi><mi mathvariant="normal">a</mi></mtext></mrow></mtd><mtd><mrow></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\quad\begin{aligned}
&amp;scope(\text{rs1})\subseteq\text{'a}\subseteq scope(\text{s1})&amp;\\
&amp;scope(\text{rs2})\subseteq\text{'a}\subseteq scope(\text{s2})&amp;\\
&amp;scope(\text{result})\subseteq\text{'a}&amp;
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05em;"></span><span class="strut bottom" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="base textstyle uncramped"><span class="mord mspace quad"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">s</span><span class="mord mathrm">1</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span><span class="mrel">⊆</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">1</span></span><span class="mclose">)</span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">s</span><span class="mord mathrm">2</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span><span class="mrel">⊆</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">2</span></span><span class="mclose">)</span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"></span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span><span class="mord mathrm">u</span><span class="mord mathrm">l</span><span class="mord mathrm">t</span></span><span class="mclose">)</span><span class="mrel">⊆</span><span class="text mord textstyle uncramped"><span class="mord mathrm">'</span><span class="mord mathrm">a</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:2em;"></span><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">scope(\text{result})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span><span class="mord mathrm">u</span><span class="mord mathrm">l</span><span class="mord mathrm">t</span></span><span class="mclose">)</span></span></span></span> satisfies these inequalities, so <code>'a</code> could be
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">t</mi></mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">scope(\text{result})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span><span class="mord mathrm">u</span><span class="mord mathrm">l</span><span class="mord mathrm">t</span></span><span class="mclose">)</span></span></span></span>, and the compiler passes the check.</p>
<h3 id="example-3" tabindex="-1"><a class="header-anchor" href="#example-3">Example 3</a></h3>
<p>This example shows an uncommon application of the assignment rule.
The constraints in the <code>where</code> clause are necessary in order to
satisfy the assignment rule.  There are also two implied constraints
from the struct reference rule: <code>'a: 'b</code> and <code>'c: 'd</code>.</p>
<pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token keyword">struct</span> <span class="token type-definition class-name">S</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'b</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'c</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'d</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'b</span> <span class="token class-name">S</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'d</span> <span class="token class-name">S</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'c</span><span class="token operator">&gt;</span> <span class="token keyword">where</span> <span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">:</span> <span class="token lifetime-annotation symbol">'c</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'b</span><span class="token punctuation">:</span> <span class="token lifetime-annotation symbol">'d</span> <span class="token punctuation">{</span>
    s
<span class="token punctuation">}</span>
</code></pre>
<h2 id="static-lifetime-and-runtime-lifetime" tabindex="-1"><a class="header-anchor" href="#static-lifetime-and-runtime-lifetime">Static lifetime and runtime lifetime</a></h2>
<p>Rust scopes and lifetimes are static lexical constructs.  They are
used to emulate lifetimes of data objects at runtime.  However, static
lifetimes could be different to runtime lifetimes, as shown in the
following example:</p>
<div class="badcode"></div>
<pre class="language-rust" tabindex="0"><code class="language-rust"><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">S</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token class-name">S</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>
    <span class="token keyword">let</span> z <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>An instance of struct <code>S</code> is first bound to <code>x</code>, then moved to <code>z</code>.
The runtime lifetime of the instance spans the whole function
invocation.  But the scope of <code>x</code> ends when <code>x</code> is moved to <code>z</code>.  Any
lifetime associated with y could not be satisfied because
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">y</mi></mtext><mo>)</mo><mo>⊈</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>p</mi><mi>e</mi><mo>(</mo><mtext><mi mathvariant="normal">x</mi></mtext><mo>)</mo></mrow><annotation encoding="application/x-tex">scope(\text{y})\nsubseteq scope(\text{x})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.79383em;"></span><span class="strut bottom" style="height:1.09657em;vertical-align:-0.30274em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.01389em;">y</span></span><span class="mclose">)</span><span class="mrel amsrm">⊈</span><span class="mord mathit">s</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">p</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="text mord textstyle uncramped"><span class="mord mathrm">x</span></span><span class="mclose">)</span></span></span></span>.  Thus the code does not
compile.</p>
<h2 id="thoughts" tabindex="-1"><a class="header-anchor" href="#thoughts">Thoughts</a></h2>
<p>In the above, we did not consider mutable variables and references.
Lifetime rules associated with mutable references are not
straightforward to abstract.  I'll take this to a follow-up post.</p>

  </div>
</div>
<div class="vskip"></div>
<script src="https://utteranc.es/client.js" repo="mechpen/mechpen.github.io" issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async="">
</script>


    </div>
  

</body></html>